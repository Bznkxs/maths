# 数学实验

## 数值积分

### 插值型积分（数学知识）

#### $n$次插值多项式

最高幂$n$，$n+1$个参数，需要取$n+1$个点$x_0, ..., x_n$来插值

对函数$f$以及取点$\{(x_i,y_i)\}_0^n$，可以用$n+1$个多项式$l_k$来描述$f$：
$$
L_n(x)=\sum_{k=0}^n {f(x_k)}l_k(x)=\sum y_kl_k(x)\\
f(x)=L_n(x)+余项R_n(x) 
$$
数值积分$I_n$就是每个多项式的积分之加**权**($y_k$) 和：
$$
A_k=\int_Sl_k(x)\mathrm{d}x,\\
I_n=\sum_kA_ky_k=A_kf(x_k),\\
I_f=I_n+\int_{S}R_n(x)\mathrm{d}x\equiv I_n+E_n
$$

#### 代数精度

设幂函数$f(x)=x^{k}$，如果存在一个**最小的**$k=m+1$使得$I_n\neq I$，那么$m$就是$I_n$的代数精度

$n+1$个节点的插值求积公式**至少**有$n$次代数精度。

$n$阶插值求积式有$2n+1$次代数精度$\iff$求积节点是$[a,b]$上的$n+1$次正交多项式的零点

#### Legendre多项式

$$
l_n(x)=\frac{1}{2^nn!}\frac{\mathrm{d}^n}{\mathrm{d}x^n}\left[(x^2-1)^n\right], n\geq1; \\
l_0(x)=1, l_1(x)=x
$$

#### Gauss公式

先将区间变换到[-1,1]，然后按上面计算。

#### 复合Gauss公式（Gauss-Lobatto）

由于-1和1是$n\geq2$的Legendre多项式的零点，所以如果把区间分成若干份，端点都是要取到的。一般阶数较小。

#### 收敛性(\*)

对积分$I$的某个数值积分$I_n$，
$$
\lim_{n\to\infty}\frac{I-I_n}{h^p}=c\neq0,
$$
那么$I_n$是$p$阶收敛的。

### 插值求积公式汇总

实际应用当中我们一般用它们的复合形式或者自适应形式。

| 名字   | 形式                                                         | 误差上界                                 | 复合收敛阶 |
| ------ | ------------------------------------------------------------ | ---------------------------------------- | ---------- |
| 梯形   | $\frac{b-a}{2}(f(a)+f(b))$                                   | $\frac{(b-a)^3}{12}\|f''\|_{\max}$       | 2          |
| 辛普森 | $\frac{b-a}{6}\left(f(a)+4f\left(\frac{a+b}{2}\right)+f(b)\right)$ | $\frac{(b-a)^5}{2880}\|f^{(4)}\|_{\max}$ | 4          |
| 高斯   | $A_1f(a)+\sum_{k=2}^{n-1}A_kf(x_k)+A_nf(b)$                  | $?$                                      | $2n-2$     |

## ODE

### ODE初值问题（数学知识）

常微分方程的一般形式：
$$
\begin{cases}
y'=f(x,y),\\
y(x_0)=a,
\end{cases}
$$
问在$\{x_i\}_0^n$处，$y$的近似取值$y_k\approx y(x_k)$。一般$x_i=x_0+ih$，步长为$h$。已知$y_0 =a$。

#### 单步法

常见的是Euler法。*t0*
$$
y_{n+1}=y_n+h\varphi(x_n,y_n,y_{n+1};h),
$$
其中$\varphi$称为增量函数；如果其跟$y_{n+1}$有关，则为隐式法；否则为显式法，可以直接计算。

#### 误差

局部截断误差：假设$y_n=y(x_n)$，讨论$y_{n+1}$的误差。

使用Taylor展开来进行分析：
$$
y(x_{n+1})=y(x_n)+hy'(x_n)+\frac{h^2}{2}y''(x_n)+O(h^3),
$$
利用局部截断假设，计算真实值（通常要Taylor展开）与估计值的差。**$h$的阶数最小的项叫做局部截断误差主项**。

#### 精度

如果局部截断误差的主项是$h^{p+1}$级的，那么称单步法具有$p$阶精度，是$p$阶方法。

#### Runge-Kutta

在每一步之内不止使用2个点。用待定参数法，将这些点处的导数($f$)值求加权平均，构造出精度更高的计算式。

由于出现了$f$在中间点的取值，所以需要用二维泰勒展开来估计$f$：
$$
\begin{split}
f(x+A,y+B)=f(x,y)+Df(x,y)+\frac{1}{2}D^2f(x,y)\\+...+\frac{1}{n!}D^nf(x,y)+O\left((A+B)^{n+1}\right),
\end{split}\\
D=A\frac{\partial}{\partial x}+B\frac{\partial}{\partial y}
$$
一般形式如下：
$$
\begin{cases}
y_{n+1}=y_n+h\sum_i\lambda_iK_i,\\
K_1=f(x_n,y_n),\\
K_i=f(x_n+c_ih, y_n+c_ih\sum_{j=1}^{i-1}a_{ij}K_j),
\end{cases}
$$
要求$\sum\lambda_i=1$, $\sum_{j=1}^{i-1}a_{ij}=1$，一共是$K_1$到$K_L$，叫做$L$阶R-K方法。

经典的龙格库塔方法是4级、4阶的。

### 方法汇总

| 名字      | 形式                                                         | 精度 |
| --------- | ------------------------------------------------------------ | ---- |
| 向前Euler | $y_{n+1}=y_n+hf(x_n,y_n)$                                    | 1    |
| 向后Euler | $y_{n+1}=y_n+hf(x_{n+1},y_{n+1})$                            | 1    |
| 梯形Euler | $y_{n+1}=y_n+\frac{h}{2}(f(x_n,y_n)+f(x_{n+1},\bar{y}_{n+1}))$ | 2    |
| 改进Euler | $\bar{y}_{n+1}=y_n+hf(x_n,y_n)$,<br/>$y_{n+1}=y_n+\frac{h}{2}(f(x_n,y_n)+f(x_{n+1},\bar{y}_{n+1}))$ | 2    |
| 龙格库塔  | 见上                                                         | L    |

 



